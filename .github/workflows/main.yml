name: CI/CD para React App with githubAction-netlify

on:
  push:
    branches:
      - main
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    # Step 1: Checkout the repository
    - name: Checkout code
      uses: actions/checkout@v3

    # Step 2: Set up Node.js
    - name: set up Node.js
      uses: actions/setup-node@v3
      with: 
        node-version: 23.8.0 # Using the Node.js version my app requires   

    # Step 3: Install dependencies
    - name: Install dependencies
      run: npm ci
    # Step 4: Executar lint
    - name: Run lint
      run: npm run lint
    # Step 5: Run tests (optional)
    - name: run tests
      run: npm run test
    # Step 6: Build the app
    - name: Build the app
      run: npm run build
    # Step 7: Deploy to Netlify
    - name: Deploy to Netlify
      uses: nwtgck/actions-netlify@v3.0
      with:
        publish-dir: ./dist #./build  ou ./dist se usar Vite
        production-deploy: true
      env:
        NETLIFY_AUTH_TOKEN: ${{secrets.NETLIFY_AUTH_TOKEN}}
        NETLIFY_SITE_ID: ${{secrets.NETLIFY_SITE_ID}}